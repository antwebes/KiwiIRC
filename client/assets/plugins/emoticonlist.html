<script id="tmpl_emoticonlistt">
var styleHtml = "<style>" +
        "#kiwi .emoticon-list {" +
        "position: absolute;" +
        "display: block;" +
        "z-index: 1000;" +
        "" +
        "background: #121314;" +
        "padding: 5px;" +
        "width: 460px;" +
        "}" +
        "" +
        "#kiwi .emoticon-list .emoticon {" +
        "display: inline-block;" +
        "width: 15px;" +
        "height: 15px;" +
        "cursor: pointer;" +
        "margin-right: 5px;" +
        "}" +
        "</style>";

    (function() {
        var emoticonsHtml = '<div class="emoticon-list">\n' +
            '<div data-text=":)" class="emoticon smile"></div>\n' +
            '<div data-text=":(" class="emoticon sad"></div>\n' +
            '<div data-text=":3" class="emoticon lion"></div>\n' +
            '<div data-text=";3" class="emoticon winky_lion"></div>\n' +
            '<div data-text=":s" class="emoticon confused"></div>\n' +
            '<div data-text=";(" class="emoticon cry"></div>\n' +
            '<div data-text=";)" class="emoticon wink"></div>\n' +
            '<div data-text=";D" class="emoticon wink_happy"></div>\n' +
            '<div data-text=":p" class="emoticon tongue"></div>\n' +
            '<div data-text="xP" class="emoticon cringe_tongue"></div>\n' +
            '<div data-text=":o" class="emoticon shocked"></div>\n' +
            '<div data-text=":D" class="emoticon happy"></div>\n' +
            '<div data-text="^.^" class="emoticon eyebrows"></div>\n' +
            '<div data-text="<3" class="emoticon heart"></div>\n' +
            '<div data-text=">_<" class="emoticon doh"></div>\n' +
            '<div data-text="xD" class="emoticon big_grin"></div>\n' +
            '<div data-text="o.0" class="emoticon wide_eye_right"></div>\n' +
            '<div data-text="0.o" class="emoticon wide_eye_left"></div>\n' +
            '<div data-text=":/" class="emoticon unsure"></div>\n' +
        '</div>\n';
        $(styleHtml).appendTo($('head'));

        var $list = $(emoticonsHtml);
        var $icon = $('<a><div class="emoticon smile"></div></a>');

        $icon.on('click', function(event) {
            event.stopPropagation();

            var $this = $(this);

            $list.appendTo($('#kiwi'))
                .show()
                .css({
                    bottom: ($('.controlbox').outerHeight()) + 'px',
                    right: 0
                });
        });

        $list.on('click', '.emoticon', function(event) {
            event.stopPropagation();

            var text = $(this).data('text');
            var $inp = $('.controlbox .inp');
            $inp.val($inp.val() + text + ' ');
        });

        $(document).on('click', function() {
            $list.hide();
        });

        kiwi.events.on('loaded', function() {
            var control = kiwi.components.ControlInput();
            control.addPluginIcon($icon);
        });
    })();
</script>
